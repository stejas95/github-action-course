name: servcie-now-check
on: [push]

jobs:

    firstJob:
        runs-on: ubuntu-latest
        steps:
            - run: echo "First job completed"

    serviceNowApproval:
        needs: firstJob
        runs-on: ubuntu-latest
        steps:
            - name: ServiceNow Manual Approval
              uses: trstringer/manual-approval@v1
              with:
                secret: ${{ secrets.GITHUB_TOKEN }}
                approvers: stejas95
                minimum-approvals: 1

    ManualChange:
        runs-on: ubuntu-latest
        needs: [firstJob, serviceNowApproval]
        if: ${{needs.serviceNowApproval.result == 'failure'}}
        steps:
            - name: manual_change
              run: echo "deploying with manual change"

    AutomatedChange:
        runs-on: ubuntu-latest
        needs: [firstJob, serviceNowApproval]
        if: ${{needs.serviceNowApproval.result == 'success'}}
        steps:
            - name: automated_change
              run: echo "deploying with automated change"